ccoord=: ((!i. 8)+/@:*(}:+/@:>{:)\@:{.),3#.}:  @:{:
ecoord=: ((!i.12)+/@:*(}:+/@:>{:)\@:{.),2#.}:"1@:}.

r=: 4 : 'a,~(}.y),~({.y)-x*a=. x<.@%~{.y'

ccubiep=: 4 : '|.(i.x)C.~(;/_1-a)+&.>-@:i.&.>;/(i.x)>:@-a=. }:|.>r&.>/;/(!i.x),y'
ccubieo=: 4 : '(,(x|x-+/))x #.inv y'

ccubie=: _8{.&>(8 ccubiep 0&{);(3 ccubieo 1&{)
ecubie=: _12{.&>(12 ccubiep 0&{);(2 ccubieo 1&{);(2 ccubieo 2&{)
